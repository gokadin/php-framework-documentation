{"version":3,"file":"/var/www/instructioner/webpack.config.ts","sources":["/var/www/instructioner/webpack.config.ts"],"names":[],"mappings":"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","sourcesContent":["/* tslint:disable: variable-name max-line-length */\n/**\n * Try to not make your own edits to this file, use the constants folder instead.\n * If more constants should be added file an issue or create PR.\n */\nimport 'ts-helpers';\n\nimport {\n  DEV_PORT, PROD_PORT, UNIVERSAL_PORT, EXCLUDE_SOURCE_MAPS, HOST,\n  USE_DEV_SERVER_PROXY, DEV_SERVER_PROXY_CONFIG, DEV_SERVER_WATCH_OPTIONS,\n  DEV_SOURCE_MAPS, PROD_SOURCE_MAPS, STORE_DEV_TOOLS,\n  MY_COPY_FOLDERS, MY_POLYFILL_DLLS, MY_VENDOR_DLLS, MY_CLIENT_PLUGINS, MY_CLIENT_PRODUCTION_PLUGINS,\n  MY_CLIENT_RULES, MY_SERVER_RULES, MY_SERVER_INCLUDE_CLIENT_PACKAGES\n} from './constants';\n\nconst {\n  ContextReplacementPlugin,\n  DefinePlugin,\n  DllPlugin,\n  DllReferencePlugin,\n  ProgressPlugin,\n  NoErrorsPlugin\n} = require('webpack');\n\nconst CompressionPlugin = require('compression-webpack-plugin');\nconst CopyWebpackPlugin = require('copy-webpack-plugin');\nconst { CheckerPlugin } = require('awesome-typescript-loader');\nconst HtmlWebpackPlugin = require('html-webpack-plugin');\nconst NamedModulesPlugin = require('webpack/lib/NamedModulesPlugin');\nconst UglifyJsPlugin = require('webpack/lib/optimize/UglifyJsPlugin');\nconst webpackMerge = require('webpack-merge');\nconst BundleAnalyzerPlugin = require('webpack-bundle-analyzer').BundleAnalyzerPlugin;\n\nconst { hasProcessFlag, includeClientPackages, root, testDll } = require('./helpers.js');\n\nconst EVENT = process.env.npm_lifecycle_event || '';\nconst AOT = EVENT.includes('aot');\nconst DEV_SERVER = EVENT.includes('webdev');\nconst DLL = EVENT.includes('dll');\nconst E2E = EVENT.includes('e2e');\nconst HMR = hasProcessFlag('hot');\nconst PROD = EVENT.includes('prod');\nconst WATCH = hasProcessFlag('watch');\nconst UNIVERSAL = EVENT.includes('universal');\n\nlet port: number;\nif (!UNIVERSAL) {\n  if (PROD) {\n    port = PROD_PORT;\n  } else {\n    port = DEV_PORT;\n  }\n} else {\n  port = UNIVERSAL_PORT;\n}\n\nconst PORT = port;\n\nconsole.log('PRODUCTION BUILD: ', PROD);\nconsole.log('AOT: ', AOT);\nif (DEV_SERVER) {\n  testDll();\n  console.log(`Starting dev server on: http://${HOST}:${PORT}`);\n}\n\nconst CONSTANTS = {\n  AOT: AOT,\n  ENV: PROD ? JSON.stringify('production') : JSON.stringify('development'),\n  HMR: HMR,\n  HOST: JSON.stringify(HOST),\n  PORT: PORT,\n  STORE_DEV_TOOLS: JSON.stringify(STORE_DEV_TOOLS),\n  UNIVERSAL: UNIVERSAL\n};\n\nconst DLL_VENDORS = [\n  '@angular/common',\n  '@angular/compiler',\n  '@angular/core',\n  '@angular/forms',\n  '@angular/http',\n  '@angular/platform-browser',\n  '@angular/platform-browser-dynamic',\n  '@angular/platform-server',\n  '@angular/router',\n  '@ngrx/core',\n  '@ngrx/core/add/operator/select.js',\n  '@ngrx/effects',\n  '@ngrx/router-store',\n  '@ngrx/store',\n  '@ngrx/store-devtools',\n  '@ngrx/store-log-monitor',\n  '@ng-bootstrap/ng-bootstrap',\n  'ngrx-store-freeze',\n  'ngrx-store-logger',\n  'rxjs',\n  ...MY_VENDOR_DLLS\n];\n\nconst COPY_FOLDERS = [\n  { from: 'src/assets', to: 'assets' },\n  { from: 'src/app/main.css' },\n  { from: 'src/app/styles.css' },\n  ...MY_COPY_FOLDERS\n];\n\nif (!DEV_SERVER) {\n  COPY_FOLDERS.unshift({ from: 'src/index.html' });\n} else {\n  COPY_FOLDERS.push({ from: 'dll' });\n}\n\nconst commonConfig = function webpackConfig(): WebpackConfig {\n  let config: WebpackConfig = Object.assign({});\n\n  config.module = {\n    rules: [\n      {\n        test: /\\.js$/,\n        loader: 'source-map-loader',\n        exclude: [EXCLUDE_SOURCE_MAPS]\n      },\n      {\n        test: /\\.ts$/,\n        loaders: [\n          '@angularclass/hmr-loader',\n          'awesome-typescript-loader?{configFileName: \"tsconfig.webpack.json\"}',\n          'angular2-template-loader',\n          'angular-router-loader?loader=system&genDir=src/compiled/src/app&aot=' + AOT\n        ],\n        exclude: [/\\.(spec|e2e|d)\\.ts$/]\n      },\n      { test: /\\.json$/, loader: 'json-loader' },\n      { test: /\\.html/, loader: 'raw-loader', exclude: [root('src/index.html')] },\n      { test: /\\.css$/, loader: 'raw-loader' },\n      ...MY_CLIENT_RULES\n    ]\n  };\n\n  config.plugins = [\n    new ContextReplacementPlugin(\n      /angular(\\\\|\\/)core(\\\\|\\/)(esm(\\\\|\\/)src|src)(\\\\|\\/)linker/,\n      root('./src')\n    ),\n    new ProgressPlugin(),\n    new CheckerPlugin(),\n    new DefinePlugin(CONSTANTS),\n    new NamedModulesPlugin(),\n    ...MY_CLIENT_PLUGINS\n  ];\n\n  if (DEV_SERVER) {\n    config.plugins.push(\n      new DllReferencePlugin({\n        context: '.',\n        manifest: require(`./dll/polyfill-manifest.json`)\n      }),\n      new DllReferencePlugin({\n        context: '.',\n        manifest: require(`./dll/vendor-manifest.json`)\n      }),\n      new HtmlWebpackPlugin({\n        template: 'src/index.html',\n        inject: false\n      })\n    );\n  }\n\n  if (DLL) {\n    config.plugins.push(\n      new DllPlugin({\n        name: '[name]',\n        path: root('dll/[name]-manifest.json'),\n      })\n    );\n  } else {\n    config.plugins.push(\n      new CopyWebpackPlugin(COPY_FOLDERS, { ignore: ['*dist_root/*'] }),\n      new CopyWebpackPlugin([{ from: 'src/assets/dist_root' }])\n    );\n  }\n\n  if (PROD) {\n    config.plugins.push(\n      new NoErrorsPlugin(),\n      new UglifyJsPlugin({\n        beautify: false,\n        comments: false\n      }),\n      new CompressionPlugin({\n        asset: '[path].gz[query]',\n        algorithm: 'gzip',\n        test: /\\.js$|\\.html$/,\n        threshold: 10240,\n        minRatio: 0.8\n      }),\n      ...MY_CLIENT_PRODUCTION_PLUGINS,\n    );\n    if (!E2E && !WATCH && !UNIVERSAL) {\n      config.plugins.push(\n        new BundleAnalyzerPlugin({analyzerPort: 5000})\n      );\n    }\n  }\n\n  return config;\n} ();\n\n// type definition for WebpackConfig at the bottom\nconst clientConfig = function webpackConfig(): WebpackConfig {\n\n  let config: WebpackConfig = Object.assign({});\n\n  config.cache = true;\n  PROD ? config.devtool = PROD_SOURCE_MAPS : config.devtool = DEV_SOURCE_MAPS;\n\n  if (DLL) {\n    config.entry = {\n      app_assets: ['./src/main.browser'],\n      polyfill: [\n        'sockjs-client',\n        '@angularclass/hmr',\n        'ts-helpers',\n        'zone.js',\n        'core-js/client/shim.js',\n        'core-js/es6/reflect.js',\n        'core-js/es7/reflect.js',\n        'querystring-es3',\n        'strip-ansi',\n        'url',\n        'punycode',\n        'events',\n        'webpack-dev-server/client/socket.js',\n        'webpack/hot/emitter.js',\n        'zone.js/dist/long-stack-trace-zone.js',\n        ...MY_POLYFILL_DLLS\n      ],\n      vendor: [...DLL_VENDORS]\n    };\n  } else {\n    if (!UNIVERSAL) {\n      if (AOT) {\n        config.entry = {\n          main: './src/main.browser.aot'\n        };\n      } else {\n        config.entry = {\n          main: './src/main.browser'\n        };\n      }\n    } else {\n      if (AOT) {\n        config.entry = {\n          main: './src/main.browser.universal.aot'\n        };\n      } else {\n        config.entry = {\n          main: './src/main.browser.universal'\n        };\n      }\n    }\n  }\n\n  if (!DLL) {\n    config.output = {\n      path: root('public'),\n      filename: 'index.js'\n    };\n  } else {\n    config.output = {\n      path: root('dll'),\n      filename: '[name].dll.js',\n      library: '[name]'\n    };\n  }\n\n  config.devServer = {\n    contentBase: AOT ? './src/compiled' : './public',\n    port: CONSTANTS.PORT,\n    historyApiFallback: {\n      disableDotRule: true,\n    },\n    stats: 'minimal',\n    host: 'instructioner.dev',\n    watchOptions: DEV_SERVER_WATCH_OPTIONS\n  };\n\n  if (USE_DEV_SERVER_PROXY) {\n    Object.assign(config.devServer, {\n      proxy: DEV_SERVER_PROXY_CONFIG\n    });\n  }\n\n  config.node = {\n    global: true,\n    process: true,\n    Buffer: false,\n    crypto: true,\n    module: false,\n    clearImmediate: false,\n    setImmediate: false,\n    clearTimeout: true,\n    setTimeout: true\n  };\n\n  return config;\n\n} ();\n\nconst serverConfig: WebpackConfig = {\n  target: 'node',\n  entry: './src/server',\n  output: {\n    filename: 'index.js',\n    path: root('dist/server'),\n    libraryTarget: 'commonjs2'\n  },\n  module: {\n    rules: [\n      { test: /ng-bootstrap/, loader: 'imports-loader?window=>global' },\n      ...MY_SERVER_RULES\n    ],\n  },\n  externals: includeClientPackages([\n    // include these client packages so we can transform their source with webpack loaders\n    ...MY_SERVER_INCLUDE_CLIENT_PACKAGES\n  ]),\n  node: {\n    global: true,\n    __dirname: true,\n    __filename: true,\n    process: true,\n    Buffer: true\n  }\n};\n\nconst defaultConfig = {\n  resolve: {\n    extensions: ['.ts', '.js', '.json']\n  }\n};\n\nif (!UNIVERSAL) {\n  DLL ? console.log('BUILDING DLLs') : console.log('BUILDING APP');\n  module.exports = webpackMerge({}, defaultConfig, commonConfig, clientConfig);\n} else {\n  console.log('BUILDING UNIVERSAL');\n  module.exports = [\n    webpackMerge({}, defaultConfig, commonConfig, clientConfig),\n    webpackMerge({}, defaultConfig, commonConfig, serverConfig)\n  ];\n}\n"]}